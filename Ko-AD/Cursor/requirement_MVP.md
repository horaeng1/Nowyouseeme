## 1. 서비스 목표 환경

- **타겟**: 일반 사용자 (영상 제작자, 유튜버, 일반 시청자 등 누구나)
- **접근 방식**: 회원 가입 없이도 사용 가능한 **웹 페이지(PC/모바일 웹)**
- **핵심 플로우(원샷)**
    1. 사용자가 영상 1개 업로드
    2. 시스템이 자동으로 AD 삽입된 새 영상을 생성
    3. 사용자는 결과 영상 파일을 다운로드

> 편집, 문장 수정, TTS 음색 세부 튜닝 등은 MVP 범위 밖
> 

---

## 2. MVP Scope 정리

### 2.1 In-Scope

1. **영상 업로드 기능**
    - 로컬 파일 업로드 (mp4 중심, 추후 확장)
    - 기본 검증: 확장자, 용량, 길이
2. **자동 AD 생성 파이프라인**
    - 오디오 → 음성 인식(대사 추출)
    - 대사/무음 구간 분석 → AD 삽입 가능한 타임슬롯 계산
    - 시각 정보(프레임) 분석 → AD에 들어갈 핵심 정보 추출
    - AD 문장 자동 생성 (한국어)
    - TTS로 AD 음성 생성
    - 원본 오디오 + AD 오디오 믹싱 → **AD 포함 단일 오디오 트랙**
3. **결과 영상 생성 및 다운로드**
    - 원본 영상 + 새 오디오 트랙으로 인코딩한 **“AD 포함 영상 파일”** 생성
    - 웹 UI에서 다운로드 링크 제공
    - 일정 시간(예: 24시간) 지난 파일은 서버에서 자동 삭제
4. **기본 진행 상태 표시**
    - “업로드 중 → 분석 중 → AD 생성 중 → 인코딩 중 → 완료” 단계 표시
    - 에러 발생 시 사용자에게 간단한 사유 안내

### 2.2 Out-of-Scope

- 웹 상에서 AD 텍스트 편집 및 재합성(TTS 재생성)
- 타임라인/스크럽 가능한 미리보기 플레이어 + AD ON/OFF
- 시리즈/폴더 단위 일괄 처리
- 다국어 지원, API 연동, 사용자 계정/결제 시스템
- AD 품질 검수용 내부 어드민 콘솔

---

## 3. Use Case

### UC-MVP-01: 단일 영상 → AD 포함 영상 변환

- **Actor**: 익명 사용자(로그인 없이)
- **Trigger**: 사용자가 웹에 접속하여 “영상에 화면해설 추가하기“ 버튼 클릭
- **Main Flow**
    1. 사용자가 영상 파일 선택 (로컬에서 mp4 업로드)
    2. 시스템이 파일 형식/용량/길이 검증
    3. 검증 통과 시 작업 큐에 등록, 진행 상태 표시
    4. 시스템이 자동으로 AD 포함 새 영상 생성
    5. 완료 후 “다운로드” 버튼 제공
- **Success Condition**
    - 사용자가 AD 포함 영상(mp4)을 로컬에 저장
- **Failure Condition**
    - 포맷/용량/길이 제한 초과
    - 처리 중 오류 발생 → 오류 메시지 + 재시도 안내

---

## 4. 기능 요구사항

### 4.1 입력/업로드

- **FR-M01**: 시스템은 **최소 1개 확장자(mp4)**에 대해 업로드를 지원해야 한다.
- **FR-M02**: 업로드 가능한 영상의 **최대 용량/최대 길이**를 설정하고, 이를 UI에 명시해야 한다.
    - 예: 1시간 이하, 2GB 이하 (구체 값은 나중에 결정)
- **FR-M03**: 업로드 후 서버에 임시 저장하고, 파일 경로/ID를 기반으로 후속 파이프라인을 실행해야 한다.
- **FR-M04**: 잘못된 포맷/손상된 파일은 업로드 시점에서 즉시 에러로 반환해야 한다.

### 4.2 AD 자동 생성 파이프라인

> 이 부분은 백엔드/모델 파이프라인 정의용
> 

### 4.2.1 음성 분석

- **FR-M10**: 시스템은 영상에서 오디오 트랙을 추출해야 한다.
- **FR-M11**: 오디오 트랙에 대해 **한국어 ASR**을 수행하여, 타임스탬프 포함 대사 스크립트를 생성해야 한다.
- **FR-M12**: 음성/무음(또는 비대사 구간) 구분을 통해 **AD 삽입 후보 구간**을 계산해야 한다.
    - 최소/최대 AD 구간 길이 정책 적용 (예: 1~5초 범위)

### 4.2.2 시각 정보 분석

- **FR-M20**: 시스템은 AD 후보 구간별로 일정 간격으로 프레임을 샘플링해야 한다.
- **FR-M21**: 샘플링된 프레임을 기반으로 **기본적인 시각 정보**를 추출해야 한다.
    - 사람/객체 존재 여부, 주요 행동/동작, 배경 변화, 화면 텍스트 등
- **FR-M22**: 분석 결과는 AD 생성 모듈이 사용 가능한 구조(JSON 등)로 전달되어야 한다.

### 4.2.3 AD 텍스트 생성

- **FR-M30**: 시스템은 각 AD 후보 구간에 대해 한국어 AD 문장을 자동 생성해야 한다.
- **FR-M31**: AD 문장은 다음 스타일 규칙을 최대한 준수해야 한다.
    - 현재 시제, 객관적 묘사 위주
    - 추측/감정/평가 표현 최소화
    - 구간 길이 대비 발화 시간 고려 (말이 다 들어갈 만큼만)
- **FR-M32**: AD 문장의 예상 발화 시간은 **TTS 기준 속도**로 거칠게 추정하여, 구간 길이를 초과하지 않도록 문장 수/길이를 조절해야 한다.
- **FR-M33**: 인접 구간에서 동일/유사 내용이 반복될 경우, 요약하거나 생략하는 간단한 중복 제거 로직을 적용해야 한다.

### 4.2.4 TTS 및 오디오 믹싱

- **FR-M40**: 시스템은 AD 문장을 TTS 엔진으로 합성하여, AD 음성 클립(구간별)을 생성해야 한다.
- **FR-M41**: TTS 음색은 MVP에서는 **고정 프리셋(예: 성별, 톤 1종)** 으로 제공해도 된다.
- **FR-M42**: 생성된 AD 음성 클립을 **해당 AD 후보 구간 타임스탬프에 정렬**하여, 원본 오디오와 시간축 상에서 병합해야 한다.
- **FR-M43**: 병합 시, 대사가 있는 구간과 AD가 겹치지 않도록, 겹침이 발생하면 AD를 잘라내거나 볼륨을 조정하는 간단한 정책을 적용해야 한다.
    - MVP에서는 “겹치면 AD를 과감히 생략/축소” 방식도 가능.

### 4.2.5 결과 영상 인코딩

- **FR-M50**: 시스템은 원본 영상의 영상 스트림과, 새로 생성된 오디오 트랙을 이용해 **최종 mp4 파일**을 인코딩해야 한다.
- **FR-M51**: 인코딩 결과 파일은 다운로드 가능한 URL과 함께 저장되어야 한다.
- **FR-M52**: 일정 기간 후(예: 24시간) 인코딩 결과와 원본 영상, 중간 산출물은 자동 삭제되어야 한다.

### 4.3 작업 상태 및 에러 처리

- **FR-M60**: 시스템은 각 업로드 건에 대해 상태(대기/처리 중/완료/실패)를 관리해야 한다.
- **FR-M61**: 웹 UI는 현재 진행 상태를 간단한 텍스트 또는 프로그레스 UI로 표시해야 한다.
- **FR-M62**: 실패 시, 사용자에게 재시도 가능 여부와 간단한 안내 문구를 제공해야 한다. (예: “영상이 너무 길거나 손상되었습니다.”)

---

## 5. 비기능 요구사항

- **NFR-M01 (처리 시간)**: 기준 사양에서 10분짜리 영상 처리 시간이 **예: 20분 이내**가 되도록 목표를 설정한다. (정확한 목표는 프로토타입 성능 측정 후 조정)
- **NFR-M02 (동시 처리)**: 초기에는 동시 처리 수를 작게 잡고(예: 1~3개), 나머지는 큐에 쌓는 방식으로 구현한다.
- **NFR-M03 (보안)**: 업로드/다운로드는 HTTPS를 사용하며, 파일은 서버 측에서 적절히 격리/암호화된 저장소에 두어야 한다.
- **NFR-M04 (저장 기간)**: 법/정책을 고려해 “업로드 후 N시간 뒤 자동 삭제” 정책을 강제한다.
- **NFR-M05 (접근성)**: 최소한 웹 UI의 핵심 버튼/텍스트는 스크린리더로 인식 가능하도록 마크업을 구성한다.

---

## 6. 이후 버전에서 확장할 기능 (레퍼런스용)

- AD 문장 편집 및 다시 합성(TTS 재생성)
- AD on/off 지원하는 전용 플레이어
- 로그인/프로젝트 관리, 결제/요금제
- 다국어 AD, API 제공, B2B 콘솔